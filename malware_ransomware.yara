rule malware_ransomeware {
    meta:
        description = "Detection of phrases used to extort payment or wallet addresses of popular cryptocurrencies"
        version = "0.1"
    strings:
        $s1 = "your files have been encrypted" nocase
        $s2 = "restore your files" nocase
        $s3 = "to make payment" nocase
        $s4 = "unless you pay" nocase
        $s5 = "pay us" nocase
        $s6 = "transfer money" nocase
        $bitcoin_leg = /[13][a-km-zA-HJ-NP-Z1-9]{25,34}/
        $bitcoin_bech = /bc1[a-zA-HJ-NP-Z0-9]{39,59}/
        $ethereum = /0x[a-fA-F0-9]{40}/
        $monero = /4[0-9AB][1-9A-HJ-NP-Za-km-z]{93}/
        $litecoin_leg = /[LM][a-km-zA-HJ-NP-Z1-9]{25,34}/
        $litecoin_seg = /ltc1[a-zA-HJ-NP-Z0-9]{39,59}/
    condition:
        any of them
}